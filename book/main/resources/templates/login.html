<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<!--     <th:block layout:fragment="title">
        <title>로그인 페이지</title>
    </th:block> -->
  	<!-- layout Content -->
		<div class="container">
	        <div class="row justify-content-center">
	            <div class="col-lg-5">
	                <div class="card shadow-lg border-0 rounded-lg mt-5">
	                    <div class="card-header"><h3 class="text-center font-weight-bold my-4">Login</h3></div>
	                    <div th:if="error">
						   <p id="valid" style="color: red; font-size:12px;"></p>
						</div>
	                    <div class="card-body">
	                        <form id="frm" name="frm" action="/login/loginProc.do" method="post">
                        	 	<div th:if="${param.error}">
							        <p th:text="${exception}" class="alert alert-danger"></p>
							    </div>
	                            <div class="form-floating mb-3">
	                                <input class="form-control" id="userId" name="userId" type="text" placeholder="name@example.com" required />
	                            </div>
	                            <div class="form-floating mb-3">
	                                <input class="form-control" id="userPassword" name="userPassword" type="password" placeholder="Password" required />
	                            </div>
	                            <div class="d-flex align-items-center justify-content-between mt-4 mb-0">
	                                <!-- <a class="small" href="javascript:">Forgot Password?</a> -->
	                                <a class="btn btn-primary" href="javascript:fnSubmit();">로그인</a>
	                                <a class="btn btn-primary" href="javascript:fnSignUp();">회원가입</a>
	                            </div>
	                        </form>
	                        <!-- 다시 게시판 화면으로 이동 --><!-- 
	                        <div id="loc" sec:authorize="isAuthenticated()" ></div> -->
	                    </div>
	                </div>
	            </div>
	        </div>
	    </div>
	    
    	<script th:src="@{/scripts/common.js}"></script>
 		<script th:src="@{/scripts/jquery.min.js}"></script>
        <script th:inline="javascript">
        	// 권한 체크 해서 로그인 했으나 다시 url 호출 하면 게시판으로
        	window.onload = function(){
        		if($("#loc").length > 0){
        			location.href = "/board/list.do";
        		}
        	}
        
        	function fn_main(){
        		location.href = "/board/list.do";	
        	}
        
       		let msg = [[${msg}]];
        	if(msg){
        		alert(msg);
        	}
       		
				
			function fnSubmit() {
				
				let frm = document.getElementById('frm');
				let fields = [frm.userId, frm.userPassword];
				let fieldNames = ['아이디','비밀번호'];
				
				// 비어있는 값 확인
				for (let i = 0, len = fields.length; i < len; i++) {
                    if ( !isValid(fields[i], fieldNames[i]) ) {
                        return false;
                    }
                }
				
				frm.submit();
		    }
			
			//회원가입
			function fnSignUp(){
				location.href = "/signUpView.do";
			}
			
		    $(function() {
		    	$("#userPassword").on("keyup", function(e) {
					if (e.key == "Enter") fnSubmit();
				});
		    });       
        </script>
</html>